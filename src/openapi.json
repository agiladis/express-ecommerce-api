{
  "openapi": "3.0.1",
  "info": {
    "title": "Express-Commerce API",
    "description": "This is a simple E-commerce server. Providing authentication and authorization, allows user to browse products, manage shopping carts, and place orders.",
    "version": "1.0.0",
    "contact": {
      "name": "API Support",
      "email": "agiladisaputro@gmail.com"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000/api/v1",
      "description": "Local development server"
    }
  ],
  "tags": [
    {
      "name": "Auth",
      "description": "Endpoints related to user authentication"
    },
    {
      "name": "Products",
      "description": "Endpoints related to Products management"
    },
    {
      "name": "Carts",
      "description": "Endpoints related to managing the shopping cart"
    },
    {
      "name": "Orders",
      "description": "Endpoints related to order processing from cart"
    }
  ],
  "paths": {
    "/auth/register": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Register a new user",
        "description": "Register a new user with valid and unique email",
        "requestBody": {
          "required": true,
          "description": "User object that needs to be added",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/User"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User successfully registered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        }
      }
    },
    "/auth/activate/{token}": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Activate a new user",
        "description": "Activate a new user with valid email",
        "parameters": [
          {
            "name": "token",
            "in": "path",
            "description": "Token to validate email",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Account activated successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        }
      }
    },
    "/auth/reactivate": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Resend a new activation token to a new user",
        "description": "Resend a new activation token to a new user with valid and unique email",
        "requestBody": {
          "required": true,
          "description": "User object that needs to be added",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResendActivationRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User successfully registered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Log in a user",
        "requestBody": {
          "required": true,
          "description": "User object that needs to be added",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/User"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User logged in success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        }
      }
    },
    "/products": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Get all products",
        "description": "Get all products. Multiple params can be provided for search by name of product, filter of category, limit of pagination.",
        "parameters": [
          {
            "name": "search",
            "in": "query",
            "description": "Name of product you want to search for",
            "schema": {
              "type": "string",
              "example": "Boneka"
            }
          },
          {
            "name": "category",
            "in": "query",
            "description": "Value that need to be considered for group product",
            "schema": {
              "type": "string",
              "example": "Mainan"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Number of items per page",
            "schema": {
              "type": "integer",
              "default": 5
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number for pagination",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "Field to sort by",
            "schema": {
              "type": "string",
              "enum": [
                "name",
                "price",
                "createdAt"
              ]
            }
          },
          {
            "name": "order",
            "in": "query",
            "description": "Sort order",
            "schema": {
              "type": "string",
              "enum": [
                "ASC",
                "DESC"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        }
      }
    },
    "/products/{id}": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Get detail of product",
        "description": "Get detail of products",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "ID of product you want to search for",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        }
      }
    },
    "/products/review/{productId}": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Get all review of product",
        "description": "Get all review of products",
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "required": true,
            "description": "ID of product you want to search for",
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Number of items per page",
            "schema": {
              "type": "integer",
              "default": 10
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number for pagination",
            "schema": {
              "type": "integer",
              "default": 1
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "Field to sort by",
            "schema": {
              "type": "string",
              "enum": [
                "updatedAt"
              ]
            }
          },
          {
            "name": "order",
            "in": "query",
            "description": "Sort order",
            "schema": {
              "type": "string",
              "enum": [
                "ASC",
                "DESC"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        }
      }
    },
    "/carts": {
      "post": {
        "tags": [
          "Carts"
        ],
        "summary": "Add product to cart",
        "requestBody": {
          "required": true,
          "description": "Object that needs to be added",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CartItem"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        },
        "security": [
          {
            "BearerAuth": []
          }
        ]
      },
      "get": {
        "tags": [
          "Carts"
        ],
        "summary": "Get user's cart item",
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        },
        "security": [
          {
            "BearerAuth": []
          }
        ]
      }
    },
    "/carts/{id}": {
      "patch": {
        "tags": [
          "Carts"
        ],
        "summary": "Update product cart quantity",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "ID of Cart item you want to update",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Object that needs to be added",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "quantity": {
                    "type": "integer",
                    "description": "The new quantity for the cart item"
                  }
                },
                "required": [
                  "quantity"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        },
        "security": [
          {
            "BearerAuth": []
          }
        ]
      }
    },
    "/orders": {
      "post": {
        "tags": [
          "Orders"
        ],
        "summary": "Create an order from cart items",
        "requestBody": {
          "required": true,
          "description": "Object that needs to be added",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "items": {
                    "type": "array",
                    "description": "cartItem's ID",
                    "items": {
                      "type": "integer"
                    }
                  }
                },
                "required": [
                  "items"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        },
        "security": [
          {
            "BearerAuth": []
          }
        ]
      },
      "get": {
        "tags": [
          "Orders"
        ],
        "summary": "Get lists of order history",
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        },
        "security": [
          {
            "BearerAuth": []
          }
        ]
      }
    },
    "/orders/{id}": {
      "get": {
        "tags": [
          "Orders"
        ],
        "summary": "Get detail order history",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "ID of order you want to see in detail",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseSuccess"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponseError"
                }
              }
            }
          }
        },
        "security": [
          {
            "BearerAuth": []
          }
        ]
      }
    }
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "User": {
        "type": "object",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "User's unique ID"
          },
          "email": {
            "type": "string"
          },
          "password": {
            "type": "string",
            "format": "password"
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "phoneNumber": {
            "type": "string"
          },
          "dateOfBirth": {
            "type": "string"
          },
          "address": {
            "type": "string"
          },
          "gender": {
            "type": "string",
            "enum": [
              "MALE",
              "FEMALE"
            ]
          },
          "isVerified": {
            "type": "boolean",
            "default": false
          },
          "reviews": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Review"
            }
          },
          "cart": {
            "$ref": "#/components/schemas/Cart"
          },
          "order": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Order"
            }
          }
        },
        "example": {
          "email": "user@gmail.com",
          "password": "user"
        },
        "xml": {
          "name": "User"
        }
      },
      "ResendActivationRequest": {
        "type": "object",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email"
          }
        },
        "xml": {
          "name": "ResendActivationRequest"
        }
      },
      "Review": {
        "type": "object",
        "required": [
          "comment",
          "rating",
          "orderId",
          "userId",
          "productId"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "Review's unique ID"
          },
          "userId": {
            "type": "integer",
            "format": "int64"
          },
          "orderId": {
            "type": "integer",
            "format": "int64"
          },
          "productId": {
            "type": "integer",
            "format": "int64"
          },
          "comment": {
            "type": "string"
          },
          "rating": {
            "type": "integer"
          }
        },
        "example": {
          "userId": 1,
          "productId": 1,
          "rating": 4,
          "comment": "Produk bagus, sesuai dengan deskripsi"
        },
        "xml": {
          "name": "Review"
        }
      },
      "Product": {
        "type": "object",
        "required": [
          "name",
          "imageUrl",
          "description",
          "price",
          "stock",
          "categoryId"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "Product's unique ID"
          },
          "categoryId": {
            "type": "integer",
            "format": "int64"
          },
          "name": {
            "type": "string"
          },
          "imageUrl": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "price": {
            "type": "number",
            "format": "float"
          },
          "stock": {
            "type": "integer"
          },
          "isAvail": {
            "type": "boolean",
            "default": true
          },
          "reviews": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Review"
            }
          },
          "orderItems": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OrderItem"
            }
          },
          "cartItems": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CartItem"
            }
          }
        },
        "example": {
          "name": "Boneka Teddy Bear",
          "imageUrl": "gambar-boneka.jpeg",
          "description": "Boneka beruang lucu",
          "price": 50000,
          "stock": 100,
          "categoryId": 1
        },
        "xml": {
          "name": "Product"
        }
      },
      "Cart": {
        "type": "object",
        "required": [
          "userId"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "Product's unique ID"
          },
          "userId": {
            "type": "integer",
            "format": "int64"
          },
          "isEmpty": {
            "type": "boolean",
            "default": false
          },
          "cartItems": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CartItem"
            }
          }
        },
        "example": {
          "userId": 1
        },
        "xml": {
          "name": "Cart"
        }
      },
      "CartItem": {
        "type": "object",
        "required": [
          "productId"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "Product's unique ID"
          },
          "cartId": {
            "type": "integer",
            "format": "int64"
          },
          "productId": {
            "type": "integer",
            "format": "int64"
          },
          "quantity": {
            "type": "integer",
            "default": 1
          }
        },
        "example": {
          "productId": 1
        },
        "xml": {
          "name": "CartItem"
        }
      },
      "Order": {
        "type": "object",
        "required": [
          "userId",
          "totalPrice"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "Order's unique ID"
          },
          "userId": {
            "type": "integer",
            "format": "int64"
          },
          "totalPrice": {
            "type": "number",
            "format": "float"
          },
          "status": {
            "type": "string",
            "description": "Order Status",
            "enum": [
              "WAITING_PAYMENT",
              "PAID",
              "PENDING",
              "SHIPPED",
              "DELIVERED",
              "CANCELED",
              "COMPLETED"
            ],
            "default": "WAITING_PAYMENT"
          },
          "orderItems": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OrderItem"
            }
          }
        },
        "example": {
          "userId": 1,
          "totalPrice": 100000
        },
        "xml": {
          "name": "Order"
        }
      },
      "OrderItem": {
        "type": "object",
        "required": [
          "orderId",
          "productId",
          "quantity"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64",
            "description": "Order Item's unique ID"
          },
          "orderId": {
            "type": "integer",
            "format": "int64"
          },
          "productId": {
            "type": "integer",
            "format": "int64"
          },
          "quantity": {
            "type": "integer",
            "format": "int32"
          },
          "isReviewed": {
            "type": "boolean",
            "default": false
          },
          "review": {
            "$ref": "#/components/schemas/Review"
          }
        },
        "example": {
          "orderId": 1,
          "productId": 1,
          "quantity": 2
        },
        "xml": {
          "name": "OrderItem"
        }
      },
      "Category": {
        "type": "object",
        "required": [
          "name"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "name": {
            "type": "string"
          },
          "products": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Product"
            }
          }
        },
        "example": {
          "name": "Mainan"
        },
        "xml": {
          "name": "Category"
        }
      },
      "ApiResponseSuccess": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "message": {
            "type": "string"
          },
          "data": {
            "type": "object"
          },
          "pagination": {
            "type": "object"
          }
        },
        "required": [
          "status",
          "message"
        ]
      },
      "ApiResponseError": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "message": {
            "type": "string"
          },
          "error": {
            "type": "string"
          },
          "pagination": {
            "type": "object"
          }
        },
        "required": [
          "status",
          "message",
          "error"
        ]
      }
    }
  },
  "security": [
    {
      "BearerAuth": []
    }
  ]
}